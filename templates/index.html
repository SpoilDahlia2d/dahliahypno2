<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Obey Loop</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
</head>
<body>
  <img id="spiral" src="{{ url_for('static', filename='background/spirale.png') }}" alt="Spiral" />
  
  <div class="hypno-text" id="text1">Empty your mind</div>
  <div class="hypno-text" id="text2" style="animation-delay: 3s;">Obey</div>

  <audio id="audio" src="{{ url_for('static', filename='audio/voice.mp3') }}" loop></audio>

  <script>
    const audio = document.getElementById('audio');
    document.body.addEventListener('click', () => {
      if (audio.paused) audio.play();
    });

    function showPopupImage(url) {
      const img = document.createElement('img');
      img.src = url;
      img.className = 'popup-image';
      img.style.top = `${Math.random() * 70 + 10}vh`;
      img.style.left = `${Math.random() * 70 + 10}vw`;
      document.body.appendChild(img);
      setTimeout(() => img.remove(), 3000);
    }

    fetch('/images')
      .then(res => res.json())
      .then(images => {
        setInterval(() => {
          const random = Math.floor(Math.random() * images.length);
          showPopupImage(images[random]);
        }, 2000);
      });
  </script>
</body>
</html>
